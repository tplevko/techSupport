<PicketLink xmlns="urn:picketlink:identity-federation:config:2.1">
	<PicketLinkSP xmlns="urn:picketlink:identity-federation:config:2.1"
		ServerEnvironment="tomcat" BindingType="REDIRECT" RelayState="someURL">
<!--                  ErrorPage="/samlerror.jsp" LogOutPage="/samllogout.jsp" SupportsSignatures="true"> -->
<!--    <PicketLinkSP xmlns="urn:picketlink:identity-federation:config:2.1"
                  ServerEnvironment="tomcat" BindingType="REDIRECT" RelayState="someURL">-->
		
        <!-- parsing the metadata file and using the published certificate is not functional yet. -->
         <!--<IDPMetadataFile>/WEB-INF/idp-metadata.xml</IDPMetadataFile>-->
       
        <!-- KeyCloak -->
        <IdentityURL>${idp.url::https://keycloak-plevko.rhcloud.com/auth/realms/saml-demo/protocol/saml}</IdentityURL>
        <!--<ServiceURL>${techSupport.url::https://localhost:8443/techSupport}</ServiceURL>-->
<!--        <ServiceURL>${techSupport.url::https://localhost:8080</ServiceURL>-->
                <ServiceURL>${techSupport.url::https://jetty-tplevko.rhcloud.com}</ServiceURL>

        <Trust>
            <!-- local server needs to be included since AuthNRequest is also checked -->
            <Domains>localhost,sts.windows.net,login.microsoftonline.com,rhcloud.com</Domains>
        </Trust>

<!--        <KeyProvider ClassName="org.picketlink.identity.federation.core.impl.KeyStoreKeyManager">
             Note:  KeyStoreKeyManager does not have references to servletcontext so keystoreURL must be filesystem location
             How to generate keystore:  https://community.jboss.org/wiki/PicketLinkX509CertificatesInSAMLMetadata
           keytool -import -file src/waad.cer -keystore src/waad_keystore.jks -alias waad-cert -keyPass waad1234 -storePass waad1234 -noprompt -trustcacerts  
            
            <Auth Key="KeyStoreURL" Value="src/waad_keystore.jks" />
            <Auth Key="KeyStorePass" Value="waad1234" />
            <Auth Key="SigningKeyPass" Value="waad1234" />
            <Auth Key="SigningKeyAlias" Value="waad-cert" />

            <ValidatingAlias Key="login.microsoftonline.com" Value="waad-cert" />
        </KeyProvider>-->
    </PicketLinkSP>
<!--
    <Handlers xmlns="urn:picketlink:identity-federation:handler:config:2.1">
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2IssuerTrustHandler" />
        
         TODO : this handler is validating the signature, should be started in the future.. 
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2SignatureValidationHandler"/>
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2AuthenticationHandler">
            <Option Key="NAMEID_FORMAT" Value="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress" />
            <Option Key="ASSERTION_SESSION_ATTRIBUTE_NAME" Value="org.picketlink.sp.assertion" />
            <Option Key="ROLE_KEY" Value="http://schemas.microsoft.com/ws/2008/06/identity/claims/role"/>
        </Handler>
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2AttributeHandler" />
    </Handlers>
    -->
    
    
<!--        
    <Handlers xmlns="urn:picketlink:identity-federation:handler:config:2.1">
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2IssuerTrustHandler" />
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2LogOutHandler" />
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2AuthenticationHandler">
            <Option Key="ASSERTION_SESSION_ATTRIBUTE_NAME" Value="org.picketlink.sp.assertion"/>
        </Handler>
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.RolesGenerationHandler" />
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2AttributeHandler" >
            <Option Key="ATTRIBUTE_CHOOSE_FRIENDLY_NAME" Value="true"/>
        </Handler>
    </Handlers>-->

    
        <Handlers xmlns="urn:picketlink:identity-federation:handler:config:2.1">
            <Handler
                class="org.picketlink.identity.federation.web.handlers.saml2.SAML2LogOutHandler" />
            <Handler
                class="org.picketlink.identity.federation.web.handlers.saml2.SAML2AuthenticationHandler">	
                <Option Key="ASSERTION_SESSION_ATTRIBUTE_NAME" Value="org.picketlink.sp.assertion"/>	
            </Handler>
            <Handler
                class="org.picketlink.identity.federation.web.handlers.saml2.RolesGenerationHandler" />
            <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2AttributeHandler" >
                <Option Key="ATTRIBUTE_CHOOSE_FRIENDLY_NAME" Value="true"/>
            </Handler>

        </Handlers>

    
    
<!--    
         Azure Config 
        <IdentityURL>https://login.microsoftonline.com/5b45da33-9e23-4543-90df-a076c2e31264/saml2</IdentityURL>
        <ServiceURL>https://localhost:8443/techSupport/</ServiceURL>

        <Trust>
            <Domains>localhost,sts.windows.net,login.microsoftonline.com,rhcloud.com</Domains>
        </Trust>

        <KeyProvider ClassName="org.picketlink.identity.federation.core.impl.KeyStoreKeyManager">
             Note:  KeyStoreKeyManager does not have references to servletcontext so keystoreURL must be filesystem location
             How to generate keystore:  https://community.jboss.org/wiki/PicketLinkX509CertificatesInSAMLMetadata
           keytool -import -file src/waad.cer -keystore src/waad_keystore.jks -alias waad-cert -keyPass waad1234 -storePass waad1234 -noprompt -trustcacerts  
            
            <Auth Key="KeyStoreURL" Value="src/waad_keystore.jks" />
            <Auth Key="KeyStorePass" Value="waad1234" />
            <Auth Key="SigningKeyPass" Value="waad1234" />
            <Auth Key="SigningKeyAlias" Value="waad-cert" />
            <ValidatingAlias Key="login.microsoftonline.com" Value="waad-cert" />
        </KeyProvider>
    </PicketLinkSP>

    <Handlers xmlns="urn:picketlink:identity-federation:handler:config:2.1">
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2IssuerTrustHandler" />
        
         TODO : this handler is validating the signature, should be started in the future.. 
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2SignatureValidationHandler"/>
      
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2AuthenticationHandler">
            <Option Key="NAMEID_FORMAT" Value="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress" />
            <Option Key="ASSERTION_SESSION_ATTRIBUTE_NAME" Value="org.picketlink.sp.assertion" />
            <Option Key="ROLE_KEY" Value="http://schemas.microsoft.com/ws/2008/06/identity/claims/role"/>
        </Handler>
        <Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2AttributeHandler" />
    </Handlers>-->
</PicketLink>